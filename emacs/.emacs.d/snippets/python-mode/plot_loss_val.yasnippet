# -*- mode: snippet -*-
# name: plot_loss_val
# key: plot_loss_val
# --
from matplotlib import pyplot as plt

train_loss = history.history["loss"]
val_loss = history.history["val_loss"]
if "acc" in history.history:
   train_acc = history.history["acc"]
   val_acc = history.history["val_acc"]
epoch_nums = len(train_loss)

if "acc" in history.history:
   fig, ax = plt.subplots(nrows=2, ncols=1, figsize=(10,10))
   loss_ax = ax[0]
else:
   fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(10,10))
   loss_ax = ax

loss_ax.set_xlabel("epochs");
loss_ax.set_ylabel("loss")
loss_ax.set_title("loss")
loss_ax.plot(range(0,epoch_nums), train_loss, label="train loss")
loss_ax.plot(range(0,epoch_nums), val_loss, label="val loss")
loss_ax.legend()

if "acc" in history.history:
   ax[1].set_xlabel("epochs");
   ax[1].set_ylabel("val")
   ax[1].set_title("accuracy")
   ax[1].plot(range(0,epoch_nums), train_acc, label="train acc")
   ax[1].plot(range(0,epoch_nums), val_acc, label="val acc")
   ax[1].legend()

plt.suptitle("train-val logs")
plt.show()